
<html>
<script src='https://d3js.org/d3.v5.min.js'></script>
<style> circle {fill: lightblue; stroke: black;} </style>
<body onload='init()'>
<svg width=300 height=300>
</svg>
<script>
async function init() {


	const data = await d3.csv("https://flunky.github.io/cars2017.csv");

	var radius = 3;
	var color = "blue";

	var margin = 50,
		width = 1000,
		height = 500;

	var x = d3.scaleLog().base(10).domain(time_extent).range([0, width]);
	var y = d3.scaleLinear().domain(count_extent).range([height, 0])

	d3.select("svg")
			.attr("width", width + 2*margin)
			.attr("height", height + 2*margin)
		.append("g")
			.attr("transform", "translate("+margin+","+margin+")")
		.selectAll().data(data).enter().append("circle")
			.attr("cx", function(d){return x(d['date']);} )
			.attr("cy", function(d){return y(d['case_number']);})
			.attr("r", radius)
			.attr("fill", color)

	// x axis
	d3.select("svg").append("g")
		.attr("transform", "translate("+margin+","+(height+margin)+")")
		.call(d3.axisBottom(x)
			.tickValues(d3.time.month, 1)
			.tickFormat(d3.format("~s")))

	// y axis
	d3.select("svg").append("g")
		.attr("transform", "translate("+margin+","+margin+")")
		.call(d3.axisLeft(y)
			.tickValues([10, 20, 50, 100])
			.tickFormat(d3.format("~s")))



}
</script>
</body>
</html>







          d3.select("svg")
            .selectAll("circle")
            .data(data)
            .enter()
            .append("circle");

          // Find range of date column
          var time_extent = d3.extent(data, function(d) {
              return d['month'];
          });

          // Find range of attendance column
          var count_extent = d3.extent(data, function(d) {
              return d['case_number'];
          })

          // Create x-axis scale mapping dates -> pixels
          var time_scale = d3.time.scale()
            .range([margin, width])
            .domain(time_extent);

          // Create y-axis scale mapping case number -> pixels
          var count_scale = d3.scale.linear()
            .range([height, margin])
            .domain(count_extent);





		format = d3.time.format("%m-%d-%Y");

		d3.tsv("world_cup_geo.tsv", function(d) {
			// transform data
			d['date'] = format.parse(d['date']);
			d['case_number'] = +d['case_number'];
			d['approval_number'] = +d['approval_number'];
			return d;
		}, draw);










        function plot_points(data) {
            
            var nested = d3.nest()
                           .key(function(d) {
                              return d['date'].getUTCFullYear();
                           })
                           .rollup(function(leaves) {
                                
                                var total = d3.sum(leaves, function(d) {
                                    return d['attendance'];
                                });

                                var coords = leaves.map(function(d) {
                                    return projection([+d.long, +d.lat]);
                                });

                                var center_x = d3.mean(coords, function(d) {
                                    return d[0];
                                });

                                var center_y = d3.mean(coords, function(d) {
                                    return d[1];
                                });

                                return {
                                  'attendance' : total,
                                  'x' : center_x,
                                  'y' : center_y
                                };
                           })
                           .entries(data);

                           debugger;
        };








        function plot_points(data) {
            //draw circles logic
            
            function agg_year(leaves) {
                var total = d3.sum(leaves, function(d) {
                    return d['attendance'];
                });

                var coords = leaves.map(function(d) {
                    return projection([+d.long, +d.lat]);
                });

                var center_x = d3.mean(coords, function(d) {
                    return d[0];
                });

                var center_y = d3.mean(coords, function(d) {
                    return d[1];
                });

                return {
                  'attendance' : total,
                  'x' : center_x,
                  'y' : center_y
                };
            }

            var nested = d3.nest()
                           .key(function(d) {
                              return d['date'].getUTCFullYear();
                           })
                           .rollup(agg_year)
                           .entries(data);

            svg.append('g')
               .attr("class", "bubble")
               .selectAll("circle")
               .data(nested)
               .enter()
               .append("circle")
              //YOUR CODE HERE
        }



















